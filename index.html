<html>

<head>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://d3js.org/topojson.v3.min.js"></script>
    <script type="text/javascript" src="chloroplethtime.js"></script>
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.10.2/themes/smoothness/jquery-ui.css" />
    <script src="https://code.jquery.com/jquery-1.9.1.js"></script>
    <script src="https://code.jquery.com/ui/1.10.2/jquery-ui.js"></script>

    <style>

    </style>
</head>

<body>
    <div id="vis1"></div>
    <p>
        <label for="amount">Date range:</label>
        <input type="text" id="amount" style="border: 0; color: #f6931f; font-weight: bold;" size="100" />
    </p>
    <div id="slider-range"></div>
    <script>
        chgraphtime();
        async function getAverageByState() {
            let countyIncome = await d3.csv('kaggle_income.csv');
            let states = new Set(d3.map(countyIncome, d => d['State_ab']));
            let statesIncome = [];

            countyIncome.forEach((d, i) => {
                d.Median = Number(d.Median)
            });
            states.forEach(d => {
                let sum = 0;
                let i = d3.filter(countyIncome, c => {
                    return c['State_ab'] === d;
                });
                i.forEach(c => {
                    sum = sum + c['Median'];
                })
                //  console.log(sum)
                statesIncome.push({ state: d, income: sum / i.length });
            });
            console.log(statesIncome)
        }
        getAverageByState();
    </script>
</body>

</html>